{"filter":false,"title":"OrderView.js","tooltip":"/app/js/views/order/OrderView.js","undoManager":{"mark":100,"position":100,"stack":[[{"group":"doc","deltas":[{"start":{"row":36,"column":14},"end":{"row":36,"column":15},"action":"insert","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":36,"column":15},"end":{"row":36,"column":16},"action":"insert","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":36,"column":16},"end":{"row":36,"column":17},"action":"insert","lines":["g"]}]}],[{"group":"doc","deltas":[{"start":{"row":36,"column":17},"end":{"row":36,"column":19},"action":"insert","lines":["()"]}]}],[{"group":"doc","deltas":[{"start":{"row":36,"column":18},"end":{"row":36,"column":19},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":36,"column":19},"end":{"row":36,"column":20},"action":"insert","lines":["h"]}]}],[{"group":"doc","deltas":[{"start":{"row":36,"column":20},"end":{"row":36,"column":21},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":36,"column":21},"end":{"row":36,"column":22},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":36,"column":22},"end":{"row":36,"column":23},"action":"insert","lines":["."]}]}],[{"group":"doc","deltas":[{"start":{"row":36,"column":23},"end":{"row":36,"column":24},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":36,"column":24},"end":{"row":36,"column":25},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":36,"column":25},"end":{"row":36,"column":26},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":36,"column":23},"end":{"row":36,"column":26},"action":"remove","lines":["sta"]},{"start":{"row":36,"column":23},"end":{"row":36,"column":28},"action":"insert","lines":["stats"]}]}],[{"group":"doc","deltas":[{"start":{"row":36,"column":29},"end":{"row":36,"column":30},"action":"insert","lines":[";"]}]}],[{"group":"doc","deltas":[{"start":{"row":36,"column":23},"end":{"row":36,"column":28},"action":"remove","lines":["stats"]},{"start":{"row":36,"column":23},"end":{"row":36,"column":24},"action":"insert","lines":["m"]}]}],[{"group":"doc","deltas":[{"start":{"row":36,"column":24},"end":{"row":36,"column":25},"action":"insert","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":36,"column":25},"end":{"row":36,"column":26},"action":"insert","lines":["d"]}]}],[{"group":"doc","deltas":[{"start":{"row":36,"column":26},"end":{"row":36,"column":27},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":36,"column":27},"end":{"row":36,"column":28},"action":"insert","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":65,"column":26},"end":{"row":65,"column":31},"action":"remove","lines":["stats"]},{"start":{"row":65,"column":26},"end":{"row":65,"column":27},"action":"insert","lines":["m"]}]}],[{"group":"doc","deltas":[{"start":{"row":65,"column":27},"end":{"row":65,"column":28},"action":"insert","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":65,"column":28},"end":{"row":65,"column":29},"action":"insert","lines":["d"]}]}],[{"group":"doc","deltas":[{"start":{"row":65,"column":29},"end":{"row":65,"column":30},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":65,"column":30},"end":{"row":65,"column":31},"action":"insert","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":36,"column":6},"end":{"row":36,"column":30},"action":"remove","lines":["console.log(this.model);"]}]}],[{"group":"doc","deltas":[{"start":{"row":30,"column":4},"end":{"row":35,"column":13},"action":"remove","lines":["  // var orders = this.dishes.orders();","      // var totalCharge = this.dishes.charge();","      // this.$('#orderStats').html(this.statsTemplate({","      //   orders: orders,","      //   totalCharge: totalCharge","      // }));"]}]}],[{"group":"doc","deltas":[{"start":{"row":30,"column":2},"end":{"row":30,"column":4},"action":"remove","lines":["  "]}]}],[{"group":"doc","deltas":[{"start":{"row":30,"column":0},"end":{"row":30,"column":2},"action":"remove","lines":["  "]}]}],[{"group":"doc","deltas":[{"start":{"row":30,"column":0},"end":{"row":31,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":30,"column":0},"end":{"row":31,"column":0},"action":"remove","lines":["      ",""]}]}],[{"group":"doc","deltas":[{"start":{"row":50,"column":65},"end":{"row":51,"column":0},"action":"insert","lines":["",""]},{"start":{"row":51,"column":0},"end":{"row":51,"column":8},"action":"insert","lines":["        "]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":8},"end":{"row":51,"column":9},"action":"insert","lines":["v"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":9},"end":{"row":51,"column":10},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":10},"end":{"row":51,"column":11},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":11},"end":{"row":51,"column":12},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":12},"end":{"row":51,"column":13},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":13},"end":{"row":51,"column":14},"action":"insert","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":14},"end":{"row":51,"column":15},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":14},"end":{"row":51,"column":15},"action":"remove","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":13},"end":{"row":51,"column":14},"action":"remove","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":12},"end":{"row":51,"column":13},"action":"remove","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":12},"end":{"row":51,"column":13},"action":"insert","lines":["p"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":13},"end":{"row":51,"column":14},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":14},"end":{"row":51,"column":15},"action":"insert","lines":["y"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":15},"end":{"row":51,"column":16},"action":"insert","lines":["m"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":16},"end":{"row":51,"column":17},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":17},"end":{"row":51,"column":18},"action":"insert","lines":["n"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":18},"end":{"row":51,"column":19},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":19},"end":{"row":51,"column":20},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":19},"end":{"row":51,"column":20},"action":"remove","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":18},"end":{"row":51,"column":19},"action":"remove","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":17},"end":{"row":51,"column":18},"action":"remove","lines":["n"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":16},"end":{"row":51,"column":17},"action":"remove","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":15},"end":{"row":51,"column":16},"action":"remove","lines":["m"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":14},"end":{"row":51,"column":15},"action":"remove","lines":["y"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":13},"end":{"row":51,"column":14},"action":"remove","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":12},"end":{"row":51,"column":13},"action":"remove","lines":["p"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":12},"end":{"row":51,"column":13},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":13},"end":{"row":51,"column":14},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":14},"end":{"row":51,"column":15},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":15},"end":{"row":51,"column":16},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":16},"end":{"row":51,"column":17},"action":"insert","lines":["p"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":17},"end":{"row":51,"column":18},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":18},"end":{"row":51,"column":19},"action":"insert","lines":["p"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":19},"end":{"row":51,"column":20},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":20},"end":{"row":51,"column":21},"action":"insert","lines":["y"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":21},"end":{"row":51,"column":22},"action":"insert","lines":["m"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":22},"end":{"row":51,"column":23},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":23},"end":{"row":51,"column":24},"action":"insert","lines":["n"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":24},"end":{"row":51,"column":25},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":25},"end":{"row":51,"column":26},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":26},"end":{"row":51,"column":27},"action":"insert","lines":["="]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":27},"end":{"row":51,"column":28},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":28},"end":{"row":51,"column":29},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":29},"end":{"row":51,"column":30},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":30},"end":{"row":51,"column":31},"action":"insert","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":31},"end":{"row":51,"column":32},"action":"insert","lines":["f"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":32},"end":{"row":51,"column":33},"action":"insert","lines":["."]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":33},"end":{"row":51,"column":34},"action":"insert","lines":["m"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":34},"end":{"row":51,"column":35},"action":"insert","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":35},"end":{"row":51,"column":36},"action":"insert","lines":["d"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":36},"end":{"row":51,"column":37},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":37},"end":{"row":51,"column":38},"action":"insert","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":38},"end":{"row":51,"column":39},"action":"insert","lines":["."]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":39},"end":{"row":51,"column":40},"action":"insert","lines":["t"]},{"start":{"row":51,"column":40},"end":{"row":51,"column":41},"action":"insert","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":39},"end":{"row":51,"column":41},"action":"remove","lines":["to"]},{"start":{"row":51,"column":39},"end":{"row":51,"column":50},"action":"insert","lines":["totalCharge"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":50},"end":{"row":51,"column":51},"action":"insert","lines":["*"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":51},"end":{"row":51,"column":52},"action":"insert","lines":["1"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":52},"end":{"row":51,"column":53},"action":"insert","lines":["0"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":53},"end":{"row":51,"column":54},"action":"insert","lines":["0"]}]}],[{"group":"doc","deltas":[{"start":{"row":51,"column":54},"end":{"row":51,"column":55},"action":"insert","lines":[";"]}]}],[{"group":"doc","deltas":[{"start":{"row":59,"column":22},"end":{"row":59,"column":43},"action":"remove","lines":["elf.model.totalCharge"]}]}],[{"group":"doc","deltas":[{"start":{"row":59,"column":21},"end":{"row":59,"column":22},"action":"remove","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":59,"column":21},"end":{"row":59,"column":22},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":59,"column":22},"end":{"row":59,"column":23},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":59,"column":23},"end":{"row":59,"column":24},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":59,"column":24},"end":{"row":59,"column":25},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":59,"column":25},"end":{"row":59,"column":26},"action":"insert","lines":["p"]}]}],[{"group":"doc","deltas":[{"start":{"row":59,"column":26},"end":{"row":59,"column":27},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":59,"column":27},"end":{"row":59,"column":28},"action":"insert","lines":["p"]}]}],[{"group":"doc","deltas":[{"start":{"row":59,"column":21},"end":{"row":59,"column":28},"action":"remove","lines":["stripep"]},{"start":{"row":59,"column":21},"end":{"row":59,"column":34},"action":"insert","lines":["stripepayment"]}]}],[{"group":"doc","deltas":[{"start":{"row":1,"column":3},"end":{"row":5,"column":40},"action":"remove","lines":["models/dish/DishCollection',","  'models/order/OrderModel',","  'models/order/PaymentModel',","  'views/home/DishCollectionView',","  'text!templates/home/statsTemplate.htm"]},{"start":{"row":1,"column":3},"end":{"row":4,"column":25},"action":"insert","lines":["jQuery',","  'Underscore',","  'Backbone',","  'models/owner/OrderMode"]},{"start":{"row":5,"column":43},"end":{"row":7,"column":30},"action":"remove","lines":[",","  'stripe',","  'libs/semantic/checkbox.min'"]},{"start":{"row":6,"column":12},"end":{"row":6,"column":24},"action":"remove","lines":["DishCollecti"]},{"start":{"row":6,"column":12},"end":{"row":6,"column":23},"action":"insert","lines":["$, _, Backb"]},{"start":{"row":6,"column":25},"end":{"row":6,"column":26},"action":"insert","lines":["e"]},{"start":{"row":6,"column":40},"end":{"row":7,"column":63},"action":"remove","lines":["PaymentModel, DishCollectionView, statsTemplate, orderTemplate, Stripe) {","  Stripe.setPublishableKey('pk_test_EMIAzyTdHHJaFEnWTNchuOTZ');"]},{"start":{"row":6,"column":40},"end":{"row":7,"column":2},"action":"insert","lines":["orderTemplate){","  "]},{"start":{"row":8,"column":6},"end":{"row":8,"column":9},"action":"remove","lines":["Ord"]},{"start":{"row":8,"column":6},"end":{"row":8,"column":10},"action":"insert","lines":["Foot"]},{"start":{"row":8,"column":19},"end":{"row":8,"column":23},"action":"remove","lines":["Pars"]},{"start":{"row":8,"column":19},"end":{"row":8,"column":26},"action":"insert","lines":["Backbon"]},{"start":{"row":9,"column":4},"end":{"row":18,"column":5},"action":"remove","lines":["tagName: \"div\",","    attributes: {","      class: 'column'","    },","","    template: _.template(orderTemplate),","","    events: {","      'click #orderBtn': 'orderSubmit'","    }"]},{"start":{"row":9,"column":4},"end":{"row":9,"column":18},"action":"insert","lines":["el: $(\"#page\")"]},{"start":{"row":12,"column":0},"end":{"row":13,"column":0},"action":"insert","lines":["",""]},{"start":{"row":13,"column":6},"end":{"row":14,"column":66},"action":"remove","lines":["_.bindAll(this, 'render', 'stripeResponseHandler', 'getAmount', 'orderSubmit');","      Stripe.setPublishableKey('pk_test_EMIAzyTdHHJaFEnWTNchuOTZ')"]},{"start":{"row":13,"column":6},"end":{"row":13,"column":21},"action":"insert","lines":["var that = this"]},{"start":{"row":14,"column":6},"end":{"row":14,"column":7},"action":"remove","lines":["P"]},{"start":{"row":14,"column":6},"end":{"row":14,"column":7},"action":"insert","lines":["v"]},{"start":{"row":14,"column":9},"end":{"row":17,"column":8},"action":"remove","lines":["se.Events.on('final:update', this.getAmount, this);","    },","","    rend"]},{"start":{"row":14,"column":9},"end":{"row":14,"column":23},"action":"insert","lines":[" options = {qu"]},{"start":{"row":14,"column":25},"end":{"row":14,"column":26},"action":"insert","lines":["y"]},{"start":{"row":14,"column":28},"end":{"row":22,"column":18},"action":"remove","lines":["function() {","      $(this.el).html(this.template());","      this.$('.ui.checkbox').checkbox();","      this.$('select.dropdown').dropdown();","      this.$('form').submit(this.orderSubmit);","      return this;","    },","","    stripeResponse"]},{"start":{"row":14,"column":28},"end":{"row":17,"column":16},"action":"insert","lines":["'thomasdavis'}","     ","","      var onData"]},{"start":{"row":17,"column":23},"end":{"row":17,"column":24},"action":"remove","lines":[":"]},{"start":{"row":17,"column":23},"end":{"row":17,"column":25},"action":"insert","lines":[" ="]},{"start":{"row":17,"column":35},"end":{"row":37,"column":9},"action":"remove","lines":["status, response) {","      var $form = $('#paymentForm');","      var self = this;","      ","      if (response.error) {","        // Show the errors on the form","        $form.find('.payment-errors').text(response.error.message);","        $('#orderBtn').prop('disabled', false);","      }","      else { // No errors, submit the form.","        // Get the token from the response:","        var token = response.id;","        var paymentDetails = new PaymentModel();","        var name = $form.find('input[name=\"first_name\"]').text();","        var stripepayment = self.model.totalCharge*100;","        ","        //name: get card name from input ","        paymentDetails.set('name', name);","        paymentDetails.set('stripeToken', token);","        paymentDetails.save(null, {","         "]},{"start":{"row":17,"column":35},"end":{"row":22,"column":24},"action":"insert","lines":["collection) {","          that.render();","      }","","      this.model = new OrderModel(options);","      this.model.fetch({"]},{"start":{"row":22,"column":32},"end":{"row":22,"column":33},"action":"insert","lines":[" "]},{"start":{"row":22,"column":35},"end":{"row":26,"column":8},"action":"remove","lines":["function(paymentDetails) {","            Parse.Cloud.run('pay', {","              amount:stripepayment,","              stripeToken: token","        "]},{"start":{"row":22,"column":35},"end":{"row":24,"column":0},"action":"insert","lines":["onDataHandler, dataType: \"jsonp\"});","",""]},{"start":{"row":24,"column":6},"end":{"row":24,"column":8},"action":"remove","lines":[" {"]},{"start":{"row":24,"column":6},"end":{"row":25,"column":0},"action":"insert","lines":["",""]},{"start":{"row":26,"column":4},"end":{"row":51,"column":63},"action":"remove","lines":["          success: function(amount) {","                //save","                alert('Success: ' + amount);","              },","              error: function(error) {","                console.log(error);","              }","            });","          },","          error: function(payment, error) {","            alert('Failed to create new object, with error code: ' + error.message);","          }","        });","      }","    },","","    getAmount: function() {","      var amount = this.final.get();","      return amount;","    },","","","    orderSubmit: function(e) {","      var $form = this.$('form');","      $form.find('#orderBtn').prop('disabled', true);","      Stripe.card.createToken($form, this.stripeResponseHandler"]},{"start":{"row":26,"column":4},"end":{"row":34,"column":36},"action":"insert","lines":["render: function(){","","      var data = {","        owner: this.model.toJSON(),","        _: _ ","      };","","      var compiledTemplate = _.template( orderTemplate, data );","      this.$el.html(compiledTemplate"]},{"start":{"row":35,"column":5},"end":{"row":35,"column":6},"action":"remove","lines":[","]},{"start":{"row":35,"column":5},"end":{"row":36,"column":0},"action":"insert","lines":["",""]},{"start":{"row":38,"column":0},"end":{"row":39,"column":0},"action":"insert","lines":["",""]},{"start":{"row":39,"column":9},"end":{"row":39,"column":12},"action":"remove","lines":["Ord"]},{"start":{"row":39,"column":9},"end":{"row":39,"column":13},"action":"insert","lines":["Foot"]}]}]]},"ace":{"folds":[],"scrolltop":1309.4666666666665,"scrollleft":0,"selection":{"start":{"row":55,"column":47},"end":{"row":55,"column":47},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":79,"state":"start","mode":"ace/mode/javascript"}},"timestamp":1421242423435,"hash":"e139d6847bc3081a111f6c7be7520276963e361d"}